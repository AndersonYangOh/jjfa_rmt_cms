var $api=new apiUtils.Api(apiUrl+"/pages/cms/contentsLayerExport"),data={siteId:parseInt(pageUtils.getQueryString("siteId")),channelId:parseInt(pageUtils.getQueryString("channelId")),contentIds:pageUtils.getQueryString("contentIds"),pageLoad:!1,pageAlert:null,columns:null,checkedLevels:null,checkedLevel:null,exportType:"zip",isAllCheckedLevel:!0,checkedLevelKeys:[],isAllDate:!0,startDate:new Date((new Date).setDate((new Date).getDate()-30)),endDate:new Date,isAllColumns:!1,columnNames:[]},methods={loadConfig:function(){var e=this;$api.get({siteId:e.siteId,channelId:e.channelId},function(t,l){if(!t&&l&&l.value){e.columns=l.value,e.columnNames=[];for(var s=0;s<e.columns.length;s++){var n=e.columns[s];n.isList&&e.columnNames.push(n.attributeName)}e.checkedLevels=l.checkedLevels;for(s=0;s<e.checkedLevels.length;s++){var a=e.checkedLevels[s];e.checkedLevelKeys.push(a.key)}e.checkedLevel=l.checkedLevel,e.pageLoad=!0}})},btnIsAllCheckedLevelClick:function(){if(this.isAllCheckedLevel=!this.isAllCheckedLevel,this.checkedLevelKeys=[],this.isAllCheckedLevel)for(var e=0;e<this.checkedLevels.length;e++){var t=this.checkedLevels[e];this.checkedLevelKeys.push(t.key)}},btnIsAllColumnsClick:function(){if(this.isAllColumns=!this.isAllColumns,this.columnNames=["Title"],this.isAllColumns)for(var e=0;e<this.columns.length;e++){var t=this.columns[e];this.columnNames.push(t.attributeName)}},btnSubmitClick:function(){var e=this;if(this.pageAlert=null,0===this.checkedLevelKeys.length)return this.pageAlert={type:"danger",html:"必须至少选择一项内容状态"};parent.pageUtils.loading(!0),$api.post({siteId:e.siteId,channelId:e.channelId,contentIds:e.contentIds,exportType:e.exportType,isAllCheckedLevel:e.isAllCheckedLevel,checkedLevelKeys:e.checkedLevelKeys,isAllDate:e.isAllDate,startDate:e.startDate,endDate:e.endDate,columnNames:e.columnNames},function(t,l){return parent.pageUtils.loading(!1),t?e.pageAlert={type:"danger",html:l.message}:l.isSuccess?(window.open(l.value),void parent.layer.closeAll()):e.pageAlert={type:"danger",html:"没有符合条件的内容，请重新选择导出条件"}})}};Vue.component("date-picker",window.DatePicker.default),new Vue({el:"#main",data:data,methods:methods,created:function(){this.loadConfig()}});